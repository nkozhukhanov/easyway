## Формат локации в событиях Bot API

- В `update.message.location` приходит объект `Location`  
  - `latitude: float` — широта  
  - `longitude: float` — долгота  
  - `horizontal_accuracy?: float` — радиус неопределённости, м  
  - `live_period?: int` — длительность живой локации, сек  
  - `heading?: int` — направление движения, °  
  - `proximity_alert_radius?: int` — радиус оповещения о сближении, м  

---

## 1. Overview / Problem
Создать Telegram‑бота, который по полученной от пользователя геолокации (или live‑локации) запрашивает у OpenAI GPT‑4.1‑mini один интересный факт о ближайшем месте и мгновенно отвечает. Первая версия (1.0) — минимально‑жизнеспособный продукт (MVP), который можно поднять за один вечер.

## 2. Key User Flows
1. **Однократная локация**  
   1. Пользователь отправляет боту точку на карте.  
   2. Бот обращается к GPT‑4.1‑mini и возвращает короткий факт.  
2. **Live‑локация (v 1.1)**  
   1. Пользователь делится текущим местоположением.  
   2. Каждые 10 мин бот получает обновлённые координаты и присылает новый факт.  
3. **Ошибочный сценарий**  
   - Если факт найти не удалось, бот отвечает: «Не получилось найти что‑то интересное, попробуйте ещё».

## 3. Functional Requirements
| № | Требование |
|---|------------|
| 3.1 | Принимать сообщения `location` (one‑time) и обновления live‑локаций. |
| 3.2 | Запрашивать `chat.completions` у модели `gpt-4.1-mini`. |
| 3.3 | System‑prompt: «Найди **один** малоизвестный факт о месте в радиусе 500 м от координат. ≤300 символов, без ссылок». |
| 3.4 | Радиус поиска фиксирован: 500 м. |
| 3.5 | Язык ответа: русский. |
| 3.6 | Технологии: TypeScript + telegraf (Cursor IDE), Docker, CI/CD GitHub → Railway. |
| 3.7 | Secrets (Telegram и OpenAI) хранить в Railway variables. |
| 3.8 | Логи выводить в консоль Railway. |
| 3.9 | **v 1.1** — таймер 10 мин для live‑локации; остановка по окончании `live_period` или отмене. |
| 3.10 | Не повторять факты для идентичных координат в рамках одной сессии. |

## 4. Non‑Goals
- Хранение истории пользователей или фактов в БД.  
- Inline‑режим, команды `/start`, `/stop`, мультиязычность, картинки.  
- Пользовательские настройки радиуса, фильтры контента.

## 5. Milestones & Release Plan
| Дата | Цель | Артефакт |
|------|------|----------|
| **Сегодня** | Создать репозиторий, настроить Railway, добавить токены | рабочий бот‑эхо |
| +2 ч | **v 1.0** — приём локации → GPT → ответ | тег `v1.0`, деплой |
| +1 ч | Тесты, устранение лагов | `v1.0.1` |
| **Завтра** | **v 1.1** — поддержка live‑локаций, цикл 10 мин | тег `v1.1` |
| После фидбэка | Решение о следующих фичах (кэш мест, мультиязык) | roadmap |

